/*!
 * mondrian-rest-client 0.0.1 (https://github.com/jazzido/mondrian-rest-client)
 * rev 15369c6
 * 
 * Copyright 2017 Datawheel, LLC
 * Licensed under MIT
 */
!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n(require("isomorphic-fetch")):"function"==typeof define&&define.amd?define(["isomorphic-fetch"],n):"object"==typeof exports?exports["mondrian-rest"]=n(require("isomorphic-fetch")):e["mondrian-rest"]=n(e["isomorphic-fetch"])}(this,function(e){return function(e){function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}var t={};return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=10)}([function(e,n,t){"use strict";function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}();Object.defineProperty(n,"__esModule",{value:!0});var o=t(5),a=t(4),u=t(1),s=function(){function e(n,t,i,o){var a=this;r(this,e),this.annotations={},this.name=n,this.caption=this.annotations.caption||n,this.measures=i,this.dimensions=t.map(function(e){return Object.assign(e,{cube:a})}),this.dimensionsByName=this.dimensions.reduce(function(e,n){return e[n.name]=n,e},{})}return i(e,[{key:"findMeasure",value:function(e){var n=this.measures.filter(function(n){return n.name===e});if(0===n.length)throw new Error("Measure "+e+" does not exist in cube "+this.name);return n[0]}},{key:"standardDimensions",get:function(){return this.dimensions.filter(function(e){return e.dimensionType===a.DimensionType.Standard})}},{key:"timeDimension",get:function(){var e=this.dimensions.filter(function(e){return e.dimensionType===a.DimensionType.Time});return e.length>0?e[0]:null}},{key:"defaultMeasure",get:function(){var e=this.measures.filter(function(e){return e.annotations.default});return e.length>0?e[0]:this.measures[0]}},{key:"query",get:function(){return new u.default(this)}}],[{key:"fromJSON",value:function(n){var t=new e(n.name,n.dimensions.map(a.default.fromJSON),n.measures.map(o.default.fromJSON),n.annotations);return t}}]),e}();n.default=s},function(e,n,t){"use strict";function r(e){if(Array.isArray(e)){for(var n=0,t=Array(e.length);n<e.length;n++)t[n]=e[n];return t}return Array.from(e)}function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}();Object.defineProperty(n,"__esModule",{value:!0});var a=t(7),u=function(){function e(n){i(this,e),this.options={nonempty:!0,distinct:!1,parents:!1,debug:!1},this.cube=n}return o(e,[{key:"drilldown",value:function(){var e=this.getLevel.apply(this,arguments);return void 0===this.drilldowns?this.drilldowns=[e]:this.drilldowns.push(e),this}},{key:"measure",value:function e(n){var e=this.cube.findMeasure(n);return void 0===this.measures?this.measures=[e]:this.measures.push(e),this}},{key:"cut",value:function(e){return void 0===this.cuts?this.cuts=[e]:this.cuts.push(e),this}},{key:"property",value:function(){var e=this.getProperty.apply(this,arguments);return void 0===this.properties?this.properties=[e]:this.properties.push(e),this}},{key:"caption",value:function(){var e=this.getProperty.apply(this,arguments);return void 0===this.captions?this.captions=[e]:this.captions.push(e),this}},{key:"option",value:function(e,n){if(!this.options.hasOwnProperty(e))throw new Error("Property "+e+" is invalid");return this.options[e]=n,this}},{key:"path",value:function(e){return"/cubes/"+this.cube.name+"/aggregate"+(e?"."+e:"")+"?"+this.qs}},{key:"getLevel",value:function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];var r=n[0],i=n[1],o=n[2];if(!(r in this.cube.dimensionsByName))throw new Error(r+" does not exist in cube "+this.cube.name);var a=this.cube.dimensionsByName[r],u=void 0===o?a.hierarchies[0].getLevel(i):a.getHierarchy(i).getLevel(o);return u}},{key:"getProperty",value:function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];if(n.length<3)throw new Error("Property specification must be Dimension.(Hierarchy).Level.Property");var i=n[n.length-1],o=this.getLevel.apply(this,r(n.slice(0,n.length-1)));if(!o.hasProperty(i))throw new Error("Property "+i+" does not exist in level "+o.fullName);return o.fullName+"."+i}},{key:"qs",get:function(){var e={drilldown:this.drilldowns?this.drilldowns.map(function(e){return e.fullName}):void 0,cut:this.cuts,measures:this.measures?this.measures.map(function(e){return e.name}):void 0,properties:this.properties,caption:this.captions,nonempty:this.options.nonempty,distinct:this.options.distinct,parents:this.options.parents,debug:this.options.debug};return a(e)}}]),e}();n.default=u},function(e,n,t){"use strict";function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}();Object.defineProperty(n,"__esModule",{value:!0});var o=t(8),a=t(9),u=t(0),s=t(3),c=t(6),f=function(){function e(n){r(this,e),this.api_base=n,this.cubesCache={}}return i(e,[{key:"cubes",value:function(){var e=this;return a(o(this.api_base,"cubes")).then(function(e){return e.json()}).then(function(n){var t=[];return n.cubes.forEach(function(n){var r=u.default.fromJSON(n);t.push(r),e.cubesCache[r.name]=r}),t})}},{key:"cube",value:function(e){var n=this;return e in this.cubesCache?Promise.resolve(this.cubesCache[e]):a(o(this.api_base,"cubes",e)).then(function(e){return e.json()}).then(function(e){var t=u.default.fromJSON(e);return n.cubesCache[t.name]=t,t})}},{key:"query",value:function(e){var n=o(this.api_base,e.path());return a(n).then(function(e){return e.json()}).then(function(t){return new s.default(t,n,e.options)})}},{key:"members",value:function(e){var n=e.hierarchy.dimension.cube;return a(o(this.api_base,"cubes",n.name,e.membersPath())).then(function(e){return e.json()}).then(function(e){return e.members.map(c.default.fromJSON)})}}]),e}();n.default=f},function(e,n,t){"use strict";function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function e(n,t,i){r(this,e),this.data=n,this.url=t,this.options=i};n.default=i},function(e,n,t){"use strict";function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}();Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(n,t,i,o,a,u){r(this,e),this.annotations={},this.name=n,this.caption=t,this.fullName=i,this.depth=o,this.annotations=a,this.properties=u}return i(e,[{key:"hasProperty",value:function(e){return this.properties.indexOf(e)!==-1}},{key:"membersPath",value:function(){return"/dimensions/"+this.hierarchy.dimension.name+"/levels/"+this.name+"/members"}}],[{key:"fromJSON",value:function(n){var t=new e(n.name,n.caption,n.full_name,n.depth,n.annotations,n.properties);return t}}]),e}();n.Level=o;var a=function(){function e(n,t,i){var o=this;r(this,e),this.name=n,this.allMemberName=t,this.levels=i.map(function(e){return Object.assign(e,{hierarchy:o})})}return i(e,[{key:"getLevel",value:function(e){var n=this.levels.find(function(n){return n.name===e});if(void 0===n)throw new Error(e+" does not exist in hierarchy "+this.name);return n}}],[{key:"fromJSON",value:function(n){var t=new e(n.name,n.all_member_name,n.levels.map(o.fromJSON));return t}}]),e}();n.Hierarchy=a;var u;!function(e){e[e.Standard=0]="Standard",e[e.Time=1]="Time"}(u=n.DimensionType||(n.DimensionType={}));var s=function(){function e(n,t,i,o,a){var s=this;switch(r(this,e),this.name=n,this.caption=t,i){case"time":this.dimensionType=u.Time;break;case"standard":this.dimensionType=u.Standard;break;default:throw new TypeError(i+" is not a valid DimensionType")}this.hierarchies=o.map(function(e){return Object.assign(e,{dimension:s})}),this.annotations=a}return i(e,[{key:"getHierarchy",value:function(e){var n=this.hierarchies.find(function(n){return n.name===e});if(void 0===n)throw new Error(e+" does not exist in dimension "+this.name);return n}}],[{key:"fromJSON",value:function(n){var t=new e(n.name,n.caption,n.type,n.hierarchies.map(a.fromJSON),n.annotations);return t}}]),e}();n.default=s},function(e,n,t){"use strict";function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}();Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(n,t,i,o){r(this,e),this.annotations={},this.name=n,this.caption=t,this.fullName=i,this.annotations=o}return i(e,null,[{key:"fromJSON",value:function(n){var t=new e(n.name,n.caption,n.full_name,n.annotations);return t}}]),e}();n.default=o},function(e,n,t){"use strict";function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}();Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(n,t,i,o,a,u,s,c,f){r(this,e),this.name=n,this.fullName=t,this.caption=i,this.allMember=o,this.drillable=a,this.depth=u,this.key=s,this.numChildren=c,this.parentName=f}return i(e,null,[{key:"fromJSON",value:function(n){return new e(n.name,n.full_name,n.caption,n["all_member?"],n["drillable?"],n.depth,n.key,n.num_children,n.parent_name)}}]),e}();n.default=o},function(e,n){e.exports=function(e,n){function t(e){return String(e).replace(s,encodeURIComponent).replace(/ /g,"+").replace(/[!'()~\*]/g,function(e){return"%"+e.charCodeAt().toString(16).slice(-2).toUpperCase()})}function r(e){var t=Object.keys(e);return n.sorted?t.sort():t}function i(e){return e.filter(function(e){return e}).join("&")}function o(e,n){return i(r(n).map(function(t){return u(e+"["+t+"]",n[t])}))}function a(e,n){return n.length?i(n.map(function(n){return u(e+"[]",n)})):t(e+"[]")}function u(e,r){var i=typeof r,u=null;return r===u?u=n.ignorenull?u:t(e)+"="+u:/string|number|boolean/.test(i)?u=t(e)+"="+t(r):Array.isArray(r)?u=a(e,r):"object"===i&&(u=o(e,r)),u}var s=new RegExp(['(?:[\0-"-&+-}-퟿-￿]|',"[�-�][�-�]|[�-�](?![�-�])|","(?:[^�-�]|^)[�-�])"].join(""),"g");return n="object"==typeof n?n:{},e&&i(r(e).map(function(n){return u(n,e[n])}))}},function(e,n,t){var r,i;!function(o,a,u){"undefined"!=typeof e&&e.exports?e.exports=u():(r=u,i="function"==typeof r?r.call(n,t,n,e):r,!(void 0!==i&&(e.exports=i)))}("urljoin",this,function(){function e(e,n){return e=e.replace(/:\//g,"://"),e=e.replace(/([^:\s])\/+/g,"$1/"),e=e.replace(/\/(\?|&|#[^!])/g,"$1"),e=e.replace(/(\?.+)\?/g,"$1&")}return function(){var n=arguments,t={};"object"==typeof arguments[0]&&(n=arguments[0],t=arguments[1]||{});var r=[].slice.call(n,0).join("/");return e(r,t)}})},function(n,t){n.exports=e},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(1);n.Query=r.default;var i=t(2);n.Client=i.default;var o=t(0);n.Cube=o.default}])});